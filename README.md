# Five

<img width="120" height="120" src="https://github.com/989ksy/Five/assets/122261047/a1da73db-c862-4fa0-8ccb-8a3d3d56c74d">

</br>
</br>

**ğŸ“¸ íƒ€ì¸ê³¼ ê³µìœ í•˜ê³  ì‹¶ì€ ìˆœê°„ì„ ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ê³µìœ í•˜ëŠ” SNS ì–´í”Œë¦¬ì¼€ì´ì…˜**


## Preview

**[íšŒì›ê°€ì… + ë¡œê·¸ì¸ UI]**

![Five_Before_Last](https://github.com/989ksy/Five/assets/122261047/971a27e9-ceb8-4e62-92eb-7882da962694)


**[ì„œë¹„ìŠ¤ UI]**

![Five_After](https://github.com/989ksy/Five/assets/122261047/b27d956d-837d-42fc-b853-4b9fa653fbe2)

</br>

## í”„ë¡œì íŠ¸

**ê°œë°œê¸°ê°„** : 2023ë…„ 11ì›” 17ì¼ ~ 2023ë…„ 12ì›” 17ì¼

**ê°œë°œì¸ì›**: 1ì¸

**iOS ìµœì†Œ ì§€ì›ë²„ì „**: 16.0 ì´ìƒ

**Package Dependency Manager**: Swift Package Manager


</br>

## íŠ¹ì§•

- íšŒì›ê°€ì…, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ, íšŒì›íƒˆí‡´ ê¸°ëŠ¥
- ì´ë¯¸ì§€, í…ìŠ¤íŠ¸ë¥¼ í¬í•¨í•œ í¬ìŠ¤íŠ¸ ë“±ë¡ ë° ì‚­ì œ
- ë‹¤ë¥¸ ìœ ì €ì˜ í¬ìŠ¤íŠ¸ ì¡°íšŒ ë° í”„ë¡œí•„ ì¡°íšŒ ê°€ëŠ¥
- ëª¨ë“  í¬ìŠ¤íŠ¸ì— ì¢‹ì•„ìš” í‘œì‹œ ë° ì·¨ì†Œ, ëŒ“ê¸€ ì‘ì„± ë° ì‚­ì œ ê¸°ëŠ¥
- ë‚´ í”„ë¡œí•„ ì´ë¯¸ì§€ ë˜ëŠ” ì´ë¦„ ë³€ê²½
- í•´ì‹œíƒœê·¸ ê²€ìƒ‰


</br>

## ìŠ¤íƒ

- `UIKit`, `CodeBaseUI`
- `Moya`, `Kingfisher`, `RxSWift`, `RxCocoa`, `SnapKit`
- `SwiftKeychainWrapper`, `YPImagePicker`, `IQKeyboardManager`
- `DiffableDatasource`, `CompositionalLayout`, `UISheetPresentation`
- `MVVM`, `Singleton`, `Input/Output`, `Repository Pattern`

</br>

## êµ¬í˜„ê¸°ëŠ¥

[**ì„œë¹„ìŠ¤**]

- **ì •ê·œí‘œí˜„ì‹**ì„ í†µí•´ ì´ë©”ì¼ ë° ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ê°’ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì¦
- **Alamofire Intercepter**ë¥¼ í†µí•´ AccessToken ë§Œë£Œ ì‹œ keychainì— ì €ì¥ëœ Refresh Tokenìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” **JWT ì¸ì¦ ë¡œì§** êµ¬í˜„
- ê²Œì‹œê¸€ ì‘ì„± ì‹œ **YPImagePicker** ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ ì»¤ìŠ¤í…€ ì§€ì›, ìµœëŒ€ 5ì¥ê¹Œì§€ ì´ë¯¸ì§€ ì„ íƒ ë° í•´ì œ ê°€ëŠ¥
- **Cursor-based pagination**ì„ í™œìš©í•˜ì—¬ ê²Œì‹œê¸€ ì¤‘ë³µì„ ë°©ì§€í•œ í”¼ë“œ ëª©ë¡ êµ¬í˜„  
- **Compositional Layout**ì„ ì‚¬ìš©í•´ì„œ ê° ì´ë¯¸ì§€ ë¹„ìœ¨ì— ëŒ€ì‘í•˜ëŠ” UICollectionView êµ¬í˜„ ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°œì„ 

[**ê·¸ì™¸**]

- **Moya**ì˜ **Router Pattern**ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ êµ¬í˜„í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì— ìš©ì´í•œ ë¡œì§ ì¶”ìƒí™”
- **RxSwift**ì™€ **MVVM Input/Output íŒ¨í„´**ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬ ë° ì½”ë“œ êµ¬ì¡° ì¼ê´€ì„± ìœ ì§€
  
</br>

 ## íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### 1. RxSwiftë¡œ êµ¬í˜„í•œ ì»¬ë ‰ì…˜ë·° cell ì´ë²¤íŠ¸ êµ¬ë…

#### [ë¬¸ì œì‚¬í•­]

í”¼ë“œ í™”ë©´ì—ì„œ ìœ ì €ì˜ ë‹‰ë„¤ì„ì„ íƒ­í•˜ì—¬ í”„ë¡œí•„ í™”ë©´ìœ¼ë¡œ ì „í™˜í•˜ê³ ì í•  ë•Œ, ë²„íŠ¼ íƒ­ ì´ë²¤íŠ¸ê°€ ì—¬ëŸ¬ ë²ˆ ë°œìƒí•˜ë©° í™”ë©´ ì „í™˜ì´ ì—°ì†í•´ì„œ ì¼ì–´ë‚¨


#### [í•´ê²°ë°©ì•ˆ]

i. subcribeìœ¼ë¡œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ viewControllerì— êµ¬í˜„í•œ disposeBagìœ¼ë¡œ í•´ë‹¹ streamì„ í•´ì œí•˜ë ¤ê³  í•¨

ii. ì´ë²¤íŠ¸ê°€ ì¤‘ë³µìœ¼ë¡œ êµ¬ë…ë˜ì–´ í•´ë‹¹ ë¬¸ì œê°€ ë°œìƒí–ˆê¸° ë•Œë¬¸ì— ê° ì…€ì— ëŒ€í•´ ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•  ë•Œ, í•´ë‹¹ ì…€ì´ ì¬ì‚¬ìš©ë˜ê¸° ì „ì— ì´ì „ì— ìƒì„±ëœ êµ¬ë…ì„ í•´ì œí•˜ê³ ì í•¨

iii. ê° ì…€ì˜ prepareForReuse ë©”ì†Œë“œ ë‚´ì—ì„œ disposeBagì„ ìƒˆë¡œ í• ë‹¹í•¨ìœ¼ë¡œì¨ ì´ì „ êµ¬ë…ì„ ëª¨ë‘ í•´ì œí•˜ê³ , ì…€ì´ ì¬ì‚¬ìš©ë  ë•Œë§ˆë‹¤ ì´ë²¤íŠ¸ë¥¼ ìƒˆë¡œ êµ¬ë… í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•¨


``` swift

override func prepareForReuse() {
      super.prepareForReuse()
      disposeBag = DisposeBag()
  }
      
            
```


``` swift

cell.nicknameButton
    .rx
    .tap
    .subscribe(with: self) { owner, _ in

        let vc = ProfileViewController()
                      
        vc.FeedUserId = element.creator.id
        vc.FeedUserProfile = element.creator.profile
        vc.type = .selectedUser
                      
        self.navigationController?.pushViewController(vc, animated: true)

}
.disposed(by: cell.disposeBag)
            
```


### 2. ì´ë¯¸ì§€ ë¹„ìœ¨ë¡œ dynamic collectionView êµ¬í˜„

#### [ë¬¸ì œì‚¬í•­]

í•´ì‹œíƒœê·¸ ê²€ìƒ‰ í™”ë©´ì„ Compositional Layoutì„ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ ë¹„ìœ¨ì— ê¸°ë°˜í•œ UIë¡œ ê¸°íš

i. kingfisherëŠ” ì´ë¯¸ì§€ë¥¼ ë¹„ë™ê¸°ë¡œ ë¡œë”©í•˜ê¸° ë•Œë¬¸ì— ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ê¸° ì „ì—ëŠ” ì •í™•í•œ ì…€ì˜ í¬ê¸°ë¥¼ ê²°ì •í•  ìˆ˜ ì—†ìŒ
ii. Compositional Layoutì´ ë ˆì´ì•„ì›ƒì„ ê²°ì •í•˜ëŠ” ì‹œì ê³¼ ì´ë¯¸ì§€ê°€ ì™„ì „íˆ ë‹¤ìš´ë¡œë“œë˜ëŠ” ì‹œì  ë¶ˆì¼ì¹˜ë¡œ ì¸í•´ ë‹¤ìš´ë¡œë“œ ëœ ì´ë¯¸ì§€ì˜ ë¹„ìœ¨ë¡œ ë ˆì´ì•„ì›ƒì„ ì¡ì„ ìˆ˜ ì—†ì—ˆìŒ

#### [ë¬¸ì œí•´ê²°]

ê²Œì‹œê¸€ ë“±ë¡ ì‹œ ì´ë¯¸ì§€ì˜ ë¹„ìœ¨ì„ ì„œë²„ë¡œ ë³´ë‚´ì„œ Compositional Layoutì´ ë ˆì´ì•„ì›ƒì„ ì¡ì„ ë•Œ í•´ë‹¹ ë¹„ìœ¨ì„ ì‚¬ìš©í•˜ì—¬ ì‹œì  ë¬¸ì œ ì—†ì´ ì…€ì˜ í¬ê¸°ë¥¼ ì¡ì„ ìˆ˜ ìˆë„ë¡ ë¡œì§ êµ¬í˜„

i. ì„œë²„ì— ì´ë¯¸ì§€ ë¹„ìœ¨ ë³´ë‚´ê¸°

``` swift

let value = Observable.combineLatest (
            input.images,
            text
        )

input.uploadTap
        .throttle(.seconds(1), scheduler: MainScheduler.instance)
        .withLatestFrom(value, resultSelector: { _, value in
            return value
        })
        .map { value in
            let datas = value.0
            let text = value.1
            
            let preview = datas.first ?? Data()
            let image = UIImage(data: preview) ?? UIImage()
            let imageSize = image.size //ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆ ì •ì˜
            let ratio = imageSize.width / imageSize.height //ì´ë¯¸ì§€ì˜ ë¹„ìœ¨ì„ êµ¬í•¨
            
            return (images: datas, text: text, ratio: ratio)
        }
        .flatMap {
            APIManager.shared.createPost(
                content: $0.text,
                file: $0.images,
                productID: "Five_Feed",
                content1: "\($0.ratio)" //ê²Œì‹œê¸€ ë“±ë¡ ì‹œ ë¹„ìœ¨ì„ ì„œë²„ì— ë³´ëƒ„
            )
        }
        .subscribe(with: self) { owner, result in
            
            switch result {
            case .success(let response):
                isSucceeded.onNext(true)
                
            case .failure(let failure):
                isSucceeded.onNext(false)
            }
        }
        .disposed(by: disposeBag)
```

ii. Compositional Layout ì¡ì„ ë•Œ ì„œë²„ì— ë³´ë‚¸ ë¹„ìœ¨ì„ í™œìš©í•˜ì—¬ Dynamic collectionView í˜•íƒœì˜ ë ˆì´ì•„ì›ƒì„ ì¡ìŒ

``` swift

func fetchAllData() {
        
        viewModel.fetchReadData { response in
            
            switch response {
                
            case .success(let success):
                self.fetchData = success.data
                
                let ratios = success.data.map{
                    Ratio(ratio: Double($0.ratio ?? "") ?? 1.0)
                } // ì„œë²„ì— ë³´ë‚¸ ë¹„ìœ¨
                
                let layout = PinterestLayout(
                    columnsCount: 2,
                    itemRatios: ratios, // ì„œë²„ì— ë³´ë‚¸ ì´ë¯¸ì§€ ë¹„ìœ¨ë¡œ ë ˆì´ì•„ì›ƒ ì¡ìŒ
                    spacing: 10,
                    contentWidth: self.view.frame.width
                )
                
                self.exploreCollectionView.collectionViewLayout = UICollectionViewCompositionalLayout(section: layout.section)
                
                self.snapshot()
                                
            case .failure(let failure):
                print("fetchAllData failed",failure.rawValue)
                print(failure.errorDescription!)
            }
        }
        
    }

```


 </br>

 ## íšŒê³ 

- RxSwiftì„ ì‚¬ìš©í•˜ë©° MVVMê³¼ Input/Output Patternì„ ëª¨ë‘ ì ìš©ì‹œì¼œ ë³¸ í”„ë¡œì íŠ¸ì˜€ìŠµë‹ˆë‹¤. 
